<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>SPRINT DYNASTY</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="app">

    <!-- ===== Top ===== -->
    <header class="topbar">
      <div class="top-left">
        <div class="badge" id="turnBadge">1年 4月 上旬</div>
        <div class="subtle" id="schoolBadge">春風高校 陸上部</div>
      </div>
      <div class="top-right">
        <div class="next-meet">
          <div class="label">NEXT</div>
          <div class="value" id="nextMeetText">新人戦 地区大会（あと3ターン）</div>
        </div>
      </div>
    </header>

    <!-- ===== Main ===== -->
    <main class="main">
      <!-- Left: scene -->
      <section class="panel scene">
        <div class="panel-head">
          <div class="panel-head-left">
            <span class="chip">シーン</span>
            <span class="scene-title" id="sceneTitle">通常練習</span>
          </div>
          <div class="panel-head-right">
            <span class="weather-hint" id="atmosphereText">夕方、風が少し冷たい。</span>
          </div>
        </div>

        <div class="scene-wrap">
          <canvas id="sceneCanvas" width="940" height="420"></canvas>
          <div class="scene-overlay">
            <div class="scene-caption" id="sceneCaption">春風高校は弱小。でも、直線は嘘をつかない。</div>
          </div>
        </div>

        <div class="scene-foot">
          <div class="coachline" id="coachLine">「焦るな。まだ時間はある。まず“自分の走り”を見つけよう。」</div>
        </div>
      </section>

      <!-- Right: status -->
      <section class="right-col">
        <section class="panel status">
          <div class="panel-head">
            <div class="panel-head-left">
              <span class="chip">主人公</span>
              <span class="player-name" id="playerNameText">（未設定）</span>
            </div>
            <div class="panel-head-right">
              <span class="chip chip-dark">怪我</span>
              <span class="injury" id="injuryText">0 / 3</span>
            </div>
          </div>

          <div class="status-grid">
            <div class="portrait">
              <div class="portrait-frame">
                <img id="playerSprite" class="pixel" src="./assets/hero_idle.png" alt="主人公ドット" />
              </div>
              <div class="portrait-sub" id="portraitSub">1年 / 春風高校</div>
            </div>

            <div class="stats" id="statsGrid"></div>
          </div>

          <div class="fatigue-block">
            <div class="fatigue-head">
              <div class="label">疲労</div>
              <div class="value"><span id="fatigueValue">0</span>%</div>
            </div>
            <div class="bar">
              <div class="bar-fill" id="fatigueBar" style="width:0%"></div>
            </div>
            <div class="fatigue-note" id="fatigueNote">疲労が高いほど成長効率が落ち、一定以上で怪我リスクが上がります。</div>
          </div>
        </section>

        <section class="panel team">
          <div class="panel-head">
            <div class="panel-head-left">
              <span class="chip">チーム</span>
              <span class="subtle">（8人・学年混在）</span>
            </div>
            <div class="panel-head-right">
              <span class="chip chip-dark">総合</span>
              <span class="subtle" id="teamPowerText">—</span>
            </div>
          </div>

          <div class="team-list" id="teamList"></div>
        </section>
      </section>
    </main>

    <!-- ===== Bottom Actions (Home) ===== -->
    <section class="panel actions">
      <div class="actions-row">
        <button class="btn btn-primary" data-action="open_training">通常練習</button>
        <button class="btn" data-action="special_stub">特殊練習（準備中）</button>
        <button class="btn btn-secondary" data-action="rest">休息</button>
        <div class="spacer"></div>
        <button class="btn" data-action="rename">名前変更</button>
        <button class="btn" data-action="reset_confirm">リセット</button>
      </div>
    </section>
  </div>

  <!-- ===== Name modal ===== -->
  <div class="modal-backdrop" id="nameModalBackdrop" hidden>
    <div class="modal">
      <div class="modal-title">名前を入力してください</div>
      <div class="modal-desc">主人公の名前はいつでも変更できます（ローカル保存）。</div>
      <input id="nameInput" class="modal-input" type="text" maxlength="12" placeholder="例：ケイスケ" />
      <div class="modal-actions">
        <button class="btn btn-secondary" id="nameRandomBtn">おまかせ</button>
        <button class="btn btn-primary" id="nameSaveBtn">決定</button>
      </div>
      <div class="modal-note">※このページを閉じても保存されます。</div>
    </div>
  </div>

  <!-- ===== Training Select (改良4：通常練習) ===== -->
  <div class="modal-backdrop" id="trainingBackdrop" hidden>
    <div class="modal modal-wide">
      <div class="modal-title">通常練習</div>
      <div class="modal-desc" id="trainingDesc">
        練習は複数選べます。やりすぎは疲労が増え、伸びは頭打ちになります。
      </div>

      <div class="training-groups">
        <div class="tgroup">
          <div class="tgroup-title">チーム練習</div>
          <div class="tlist" id="teamTrainingList"></div>
        </div>
        <div class="tgroup">
          <div class="tgroup-title">個人練習</div>
          <div class="tlist" id="soloTrainingList"></div>
        </div>
      </div>

      <div class="training-foot">
        <div class="training-preview">
          <div class="preview-line" id="trainingPreview">選択：0件 / 予想疲労：+0 / 伸び効率：100%</div>
          <div class="preview-sub" id="trainingWarn">疲労が高い状態で強い練習をすると怪我の危険が増えます。</div>
        </div>
        <div class="training-actions">
          <button class="btn btn-secondary" id="trainingCancelBtn">戻る</button>
          <button class="btn btn-primary" id="trainingGoBtn">練習開始 → 次ターンへ</button>
        </div>
      </div>
    </div>
  </div>

  <script src="./data.js"></script>
  <script src="./ui.js"></script>
  <script src="./game.js"></script>
</body>
</html>
